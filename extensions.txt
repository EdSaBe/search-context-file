;!
;! Automatically generated configuration file
;! Filename: extensions.conf (/etc/asterisk/extensions.conf)
;! Generator: Manager
;! Creation Date: Fri May 31 09:38:40 2019
;!

[general]
static = yes
writeprotect = no
clearglobalvars = no

[globals]
CONSOLE = Console/dsp  ; Console interface for demo
TRUNKMSD = 1  ; MSD digits to strip (usually 1 or 0)
FEATURES = 

RINGTIME = 20
FOLLOWMEOPTIONS = 
PAGING_HEADER = Intercom
; SIP Router definitions
; Elstree
trunk1.sip.els.tt.local = SIP/trunk1.sip.els.tt.local
trunk2.sip.els.tt.local = SIP/trunk2.sip.els.tt.local
trunk3.sip.els.tt.local = SIP/trunk3.sip.els.tt.local
; Bolton
trunk1.sip.blt.tt.local = SIP/trunk1.sip.blt.tt.local
trunk2.sip.blt.tt.local = SIP/trunk2.sip.blt.tt.local
trunk3.sip.blt.tt.local = SIP/trunk3.sip.blt.tt.local
; Other PBX
pbx2.tc7.blt.sip.tt.local = SIP/pbx2.tc7.blt.sip.tt.local
CID_2999 = 08000155989

CID_2001 = 02070521601
CID_2002 = 02070521602
CID_2011 = 02070521603
CID_2012 = 02070521602
CID_2003 = 08000155989
CID_2998 = +442070521604
CID_2997 = +442070521604
CID_2996 = +442070521604

CID_2995 = +442070521604
CID_2101 = +442070521600
#include "tt.ringgroups.conf"

CID_2102 = +442070521604
#include "include/extensions_gage_nonreplicated.conf"


CID_2990 = +442070521604
#include "include/extensions_gage.conf"

DIALOPTIONS = TtL(1815000[:15000])
#include "include/extensions_blocked_countries.conf"



; CCPM CID End

[default]

exten = _*7XXXX,1,PickupChan(SIP/${EXTEN:2})
include = tt.hints
include = tt.extensions
include = stdexten

[DID_PR-GN-SIP-01]
include = tt.inbound.blocked
include = tt.inbound.override
include = DID_PR-GN-SIP-01_default
include = tt.inbound.notrouted

[tt.inbound.notrouted]


[tt.inbound.override]



[DID_PR-GN-SIP-01_default]


exten = 02070521602,1,Goto(default,2002,1)

exten = 02070521608,1,Goto(ringroups-custom-1,s,1)



exten = 02070521609,1,Goto(ringroups-custom-2,s,1)


exten = 02070521606,1,Goto(tt.queue.routing.149,s,1)
exten = 02070521604,1,Goto(tt.queue.routing.147,s,1)
exten = 02070521605,1,Goto(tt.queue.routing.148,s,1)
exten = 02070521603,1,Goto(default,2990,1)
exten = 02070521607,1,Goto(conferences,8001,1)

exten = 02070521601,1,Goto(default,2001,1)
exten = 02070521600,1,Goto(ivr-menu-3300,s,1)




[Local_Only]
include = conferences
include = ringgroups
include = voicemenus
include = queues
include = default

[CallingRule_StandardUKCalls]
exten = _0[1-8]X.,1,Macro(DialOutbound,${EXTEN},OUT)
exten = _44XXX.,1,Macro(DialOutbound,0${EXTEN:2},OUT)
exten = _**XX0[1-8]X.,1,Macro(DialOutbound,${EXTEN},OUT)
exten = _*1410[1-8]X.,1,Macro(DialOutbound,${EXTEN},OUT)
exten = _+44X.,1,Macro(DialOutbound,0${EXTEN:3},OUT)
[CallingRule_EmergencyServices]
exten = 999,1,Macro(DialOutbound,${EXTEN},OUT)
[CallingRule_NonEmergencyServices]
exten = 112,1,Macro(DialOutbound,${EXTEN},OUT)
exten = 111,1,Macro(DialOutbound,${EXTEN},OUT)
exten = 101,1,Macro(DialOutbound,${EXTEN},OUT)
[CallingRule_118Calls]
exten = _118XXX,1,Macro(DialOutbound,${EXTEN},OUT)
[CallingRule_GageServiceDesk]
exten = 611,1,Macro(DialOutbound,${EXTEN},OUT)
[CallingRule_SpeakingClock]
exten = 123,1,Macro(DialOutbound,${EXTEN},OUT)
[CallingRule_International]
exten = _00X.,1,Macro(DialOutbound,${EXTEN},OUT)
exten = _+X.,1,Macro(DialOutbound,00${EXTEN:1},OUT)

[CallingRule_CompanyOnly]
exten = _0[1-8]X.,1,Macro(CheckCompanyOnly,44${EXTEN:1},${EXTEN},OUT)
exten = _**XX0[1-8]X.,1,Macro(CheckCompanyOnly,44${EXTEN:5},${EXTEN},OUT)
exten = _*1410[1-8]X.,1,Macro(CheckCompanyOnly,44${EXTEN:5},${EXTEN},OUT)
exten = _00X.,1,Macro(CheckCompanyOnly,${EXTEN:2},${EXTEN},OUT)
exten = _+X.,1,NoOp(*** Dialing out using + ***)
exten = _+X.,n,Macro(CheckCompanyOnly,${EXTEN:1},00${EXTEN:1},OUT)
exten = _**XX00X.,1,Macro(CheckCompanyOnly,${EXTEN:6},${EXTEN},OUT)
exten = _*14100X.,1,Macro(CheckCompanyOnly,${EXTEN:6},${EXTEN},OUT)

[conferences]

exten = 8020,1,Answer()
exten = 8020,n,ConfBridge(${EXTEN},bridge_8020,user_8020)



exten = 8002,1,Answer()
exten = 8002,n,ConfBridge(${EXTEN},bridge_8002,user_8002)
exten = 8001,1,Answer()
exten = 8001,n,ConfBridge(${EXTEN},bridge_8001,user_8001)

[ringgroups]
exten = 3101,1,Goto(ringroups-custom-1,s,1)
exten = 3102,1,Goto(ringroups-custom-2,s,1)


[voicemenus]
exten = 3300,1,Goto(ivr-menu-3300,s,1)


[queues]

[DLPN_All]
include => DLPN_External

[DLPN_External]
include = CallingRule_Blocked_Countries
include = CallingRule_StandardUKCalls
include = CallingRule_EmergencyServices
include = CallingRule_NonEmergencyServices
include = CallingRule_118Calls
include = CallingRule_GageServiceDesk
include = CallingRule_SpeakingClock
include = CallingRule_International
include = default
include = conferences
include = ringgroups
include = voicemenus
include = queues

[DLPN_CompanyOnly]
include = CallingRule_Blocked_Countries
include = CallingRule_CompanyOnly
include = CallingRule_EmergencyServices
include = CallingRule_NonEmergencyServices
include = CallingRule_118Calls
include = CallingRule_GageServiceDesk
include = CallingRule_SpeakingClock
include = default
include = conferences
include = ringgroups
include = voicemenus
include = queues

[tt.voicemail]
exten = _X.,1,Voicemail(${EXTEN})

[tt.hints]
exten = 2999,hint,SIP/2999
exten = 2001,hint,SIP/2001
exten = 2002,hint,SIP/2002
exten = 2011,hint,SIP/2011
exten = 2012,hint,SIP/2012
exten = 2003,hint,SIP/2003
exten = 2998,hint,SIP/2998
exten = 2997,hint,SIP/2997
exten = 2996,hint,SIP/2996
exten = 2995,hint,SIP/2995
exten = 2101,hint,SIP/2101
exten = 2102,hint,SIP/2102
exten = 2990,hint,SIP/2990




[tt.extensions]
exten = 2999,1,Gosub(stdexten-NoVM,2999,1(${HINT}))
exten = 2001,1,Gosub(2001,stdexten(${HINT}))
exten = 2002,1,Gosub(2002,stdexten(${HINT}))
exten = 2011,1,Gosub(2011,stdexten(${HINT}))
exten = 2012,1,Gosub(2012,stdexten(${HINT}))



exten = 2003,1,Gosub(2003,stdexten(${HINT}))
exten = 2998,1,Gosub(2998,stdexten(${HINT}))
exten = 2997,1,Gosub(stdexten-NoVM,2997,1(${HINT}))
exten = 2996,1,Gosub(stdexten-NoVM,2996,1(${HINT}))
exten = 2995,1,Gosub(2995,stdexten(${HINT}))
exten = 2101,1,Gosub(stdexten-NoVM,2101,1(${HINT}))
exten = 2102,1,Gosub(stdexten-NoVM,2102,1(${HINT}))
exten = 3031,1,Goto(tt.queue.routing.147,s,1)
exten = 3032,1,Goto(tt.queue.routing.148,s,1)
exten = 3033,1,Goto(tt.queue.routing.149,s,1)
exten = 3034,1,Goto(tt.queue.routing.147,s,1)
exten = 2990,1,Gosub(2990,stdexten(${HINT}))



[tt.inbound.blocked]

[tt.blocked]
exten = s,1,NoOp(**** Abusive call from ${CALLERID(num)} ****)
exten = s,n,Hangup()

[tt.subPublicHoliday.EnglandandWales]
exten = s,1,Goto(${STRFTIME(${EPOCH},,%F)},1)
exten = 2015-12-25,1,Return(1)
exten = 2015-12-28,1,Return(1)
exten = 2016-01-01,1,Return(1)
exten = 2016-03-25,1,Return(1)
exten = 2016-03-28,1,Return(1)
exten = 2016-05-02,1,Return(1)
exten = 2016-05-30,1,Return(1)
exten = 2016-08-29,1,Return(1)
exten = 2016-12-26,1,Return(1)
exten = 2016-12-27,1,Return(1)
exten = 2017-01-02,1,Return(1)
exten = 2017-04-14,1,Return(1)
exten = 2017-04-17,1,Return(1)
exten = 2017-05-01,1,Return(1)
exten = 2017-05-29,1,Return(1)
exten = 2017-08-28,1,Return(1)
exten = 2017-12-25,1,Return(1)
exten = 2017-12-26,1,Return(1)
exten = i,1,Return(0)
[tt.subPublicHoliday.Scotland]
exten = s,1,Goto(${STRFTIME(${EPOCH},,%F)},1)
exten = 2015-11-30,1,Return(1)
exten = 2015-11-25,1,Return(1)
exten = 2015-12-28,1,Return(1)
exten = 2016-01-01,1,Return(1)
exten = 2016-01-04,1,Return(1)
exten = 2016-03-25,1,Return(1)
exten = 2016-05-02,1,Return(1)
exten = 2016-05-30,1,Return(1)
exten = 2016-08-01,1,Return(1)
exten = 2016-11-30,1,Return(1)
exten = 2016-12-26,1,Return(1)
exten = 2016-12-27,1,Return(1)
exten = 2017-01-02,1,Return(1)
exten = 2017-01-03,1,Return(1)
exten = 2017-04-14,1,Return(1)
exten = 2017-05-01,1,Return(1)
exten = 2017-05-29,1,Return(1)
exten = 2017-08-07,1,Return(1)
exten = 2017-11-30,1,Return(1)
exten = 2017-12-25,1,Return(1)
exten = 2017-12-26,1,Return(1)
exten = i,1,Return(0)

[tt.subPublicHoliday.Master]
exten = s,1,Goto(${STRFTIME(${EPOCH},,%F)},1)
exten = 2018-12-25,1,Return(1)
exten = 2018-12-27,1,Return(1)
exten = 2019-01-01,1,Return(1)
exten = i,1,Return(0)

[tt.subPublicHoliday.MasterNewOne]
exten = s,1,Goto(${STRFTIME(${EPOCH},,%F)},1)
exten = 2018-12-25,1,Return(1)
exten = i,1,Return(0)

[ivr-menu-3300]
exten = s,1,Answer()
exten = s,2,Background(record/1553082254-835617311)
exten = s,n,WaitExten(10)
exten = e,1,Goto(s,2)
exten = 0,1,Goto(conferences,8001,1)
exten = 1,1,Goto(default,2001,1)
exten = 2,1,Goto(default,2002,1)
exten = 3,1,Goto(tt.queue.routing.147,s,1)
exten = 4,1,Goto(tt.queue.routing.148,s,1)
exten = 5,1,Goto(tt.queue.routing.149,s,1)
exten = 6,1,Dial(Local/3102@DLPN_All)
exten = 7,1,Dial(Local/3101@DLPN_All)


[recording_library_30]
exten = s,1,NoOp()
exten = s,n,Playback(record/1511179548-1349967840)
exten = s,n,Return()

[tt.queue.routing.149]
exten = s,1,Answer()
exten = s,n,Gosub(VIPRouting,s,1(routing149))
exten = s,n,Set(CALLERID(name)=Technical Services ${CALLERID(name)})
exten = s,n,Queue(ttqueue2,,,,60)
exten = s,n,Hangup()
[ttqueue1.voicemail]
exten = 1,1,Voicemail(CallbackVoicemail_ttqueue1,)

[tt.queue.routing.147]
exten = s,1,Answer()
exten = s,n,Gosub(VIPRouting,s,1(routing147))
exten = s,n,Set(CALLERID(name)=Customer Services ${CALLERID(name)})
exten = s,n,Queue(ttqueue3,,,,60)
exten = s,n,Hangup()

[tt.queue.routing.148]
exten = s,1,Answer()
exten = s,n,Gosub(VIPRouting,s,1(routing148))
exten = s,n,Set(CALLERID(name)=Premium Customers ${CALLERID(name)})
exten = s,n,Queue(ttqueue1,,,,60,,,recording_platform_8023065)
exten = s,n,Hangup()
[recording_platform_8023065]
exten = s,1,NoOp()
exten = s,n,Playback(record/1553082254-835617311)
exten = s,n,Return()

[VIPRouting]
exten = s,1,NoOp(VIP Caller Check - Caller ID = ${CALLERID(num)} & Queue = ${ARG1})
exten = s,n,GotoIf($[${DB_EXISTS(VIPCLI/${CALLERID(num)}/${ARG1})}]?vipReroute,1)
exten = s,n,Return()
exten = vipReroute,1,Goto(VIPCLIRoute,${CALLERID(num)},1)

[VIPCLIRoute]
[tt.subPublicHoliday.TC7Specific]
exten = s,1,Goto(${STRFTIME(${EPOCH},,%F)},1)
exten = 2019-04-17,1,Return(1)
exten = i,1,Return(0)
